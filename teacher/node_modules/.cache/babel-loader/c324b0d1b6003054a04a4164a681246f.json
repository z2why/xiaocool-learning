{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nexport default {\n  data() {\n    return {\n      //获取班级列表的参数对象\n      queryInfo: {\n        // 当前的页数\n        pageNum: 1,\n        // 当前每页显示多少条数据\n        pageSize: 6,\n        teaId: '',\n        classId: '',\n        className: '',\n        deleted: 0\n      },\n      search: '',\n      condition: '',\n      user: {},\n      classlist: [],\n      total: 0,\n      // 控制添加班级对话框的显示与隐藏\n      addDialogVisible: false,\n      // 添加班级的表单数据\n      addForm: {\n        className: '',\n        teaName: '',\n        classStudentNum: 0,\n        teaId: '',\n        deleted: 0\n      },\n      // 添加表单的验证规则对象\n      addFormRules: {\n        className: [{\n          required: true,\n          message: '请输入班级名称',\n          trigger: 'blur'\n        }]\n      },\n      // 修改表单的验证规则对象\n      editFormRules: {\n        className: [{\n          required: true,\n          message: '请输入班级名称',\n          trigger: 'blur'\n        }]\n      },\n      // 控制修改班级对话框的显示与隐藏\n      editDialogVisible: false,\n      // 查询到的班级信息对象\n      editForm: {\n        classId: '',\n        className: '',\n        teaId: '',\n        classStudentNum: 0,\n        deleted: 0\n      },\n      delete: {\n        classId: '',\n        deleted: 1\n      }\n    };\n  },\n  mounted() {},\n  created() {\n    this.getUserList();\n  },\n  methods: {\n    togetUserList() {\n      this.condition = '';\n      this.getUserList();\n    },\n    //查询班级列表\n    getUserList() {\n      this.user = JSON.parse(localStorage.getItem(\"user\"));\n      // console.log(this.user);\n      this.queryInfo.teaId = parseInt(this.user.teaId);\n      this.addForm.teaId = this.user.teaId;\n      this.editForm.teaId = this.user.teaId;\n      this.addForm.teaName = this.user.truename;\n      // console.log(this.addForm)\n      // console.log(\"condition\"+this.condition)\n      this.search = this.condition;\n      if (this.search === '') {\n        this.queryInfo.classId = '';\n        this.queryInfo.className = '';\n        this.request.get('/service-class/class/page', {\n          params: this.queryInfo\n        }).then(res => {\n          if (res.code === '200') {\n            this.classlist = res.data.records;\n            // console.log(this.classlist)\n            this.total = res.data.total;\n          } else {\n            this.$message.error(\"获取班级列表失败！\");\n          }\n        });\n      } else if (this.search !== '') {\n        this.queryInfo.classId = this.search;\n        this.queryInfo.pageSize = 6;\n        this.queryInfo.pageNum = 1;\n        this.request.get('/service-class/class/page', {\n          params: this.queryInfo\n        }).then(res => {\n          if (res.code === '200') {\n            this.classlist = res.data.records;\n            // console.log(\"输入的搜索条件是classId\")\n            // console.log(this.classlist)\n            if (this.classlist.length === 0) {\n              this.queryInfo.classId = '';\n              this.queryInfo.className = this.search;\n              this.request.get('/service-class/class/page', {\n                params: this.queryInfo\n              }).then(res => {\n                if (res.code === '200') {\n                  // console.log(this.queryInfo,\"qu\")\n                  this.classlist = res.data.records;\n                  // console.log(\"输入的搜索条件是className\")\n                  // console.log(this.classlist)\n                  this.total = res.data.total;\n                  if (this.classlist.length === 0) {\n                    this.$message.info(\"搜索结果为空！\");\n                  }\n                } else {\n                  this.$message.error(\"获取班级列表失败！\");\n                }\n              });\n            } else {\n              this.total = res.data.total;\n              if (this.classlist.length === 0) {\n                this.$message.info(\"搜索结果为空！\");\n              }\n            }\n          } else {\n            this.$message.error(\"获取班级列表失败！\");\n          }\n        });\n      }\n    },\n    // 监听pagesize改变的事件\n    handleSizeChange(newSize) {\n      // console.log(\"pageSize=\"+newSize)\n      this.queryInfo.pageSize = newSize;\n      this.getUserList();\n    },\n    // 监听页码值改变的事件\n    handleCurrentChange(newPage) {\n      // console.log(\"pageNum=\"+newPage)\n      this.queryInfo.pageNum = newPage;\n      this.getUserList();\n    },\n    // 监听添加班级对话框的关闭事件\n    addDialogClosed() {\n      this.$refs.addFormRef.resetFields();\n    },\n    // 点击按钮，添加新班级\n    addClass() {\n      // console.log(this.addForm)\n      this.$refs['addFormRef'].validate(valid => {\n        if (valid) {\n          this.request.post(\"/service-class/class\", this.addForm).then(res => {\n            if (res.code === '200') {\n              this.$message.success(\"新增班级成功！\");\n              // 隐藏添加班级的对话框\n              this.addDialogVisible = false;\n              // 重新获取班级列表数据\n              this.getUserList();\n            } else {\n              this.$message.error(\"新增班级失败!\");\n            }\n          });\n        }\n      });\n    },\n    // 展示编辑班级的对话框\n    showEditDialog(classId, className) {\n      this.editDialogVisible = true;\n      this.editForm.className = className;\n      this.editForm.classId = classId;\n      // console.log(this.editForm)\n      this.editDialogVisible = true;\n    },\n    // 监听修改班级对话框的关闭事件\n    editDialogClosed() {\n      this.$refs.editFormRef.resetFields();\n    },\n    // 修改信息并提交\n    editClassInfo() {\n      this.$refs['editFormRef'].validate(valid => {\n        if (valid) {\n          this.request.post(\"/service-class/class\", this.editForm).then(res => {\n            if (res.code === '200') {\n              this.$message.success(\"修改班级成功！\");\n              // 隐藏修改班级的对话框\n              this.editDialogVisible = false;\n              // 重新获取班级列表数据\n              this.getUserList();\n            } else {\n              this.$message.error(\"修改班级失败!\");\n            }\n          });\n        }\n      });\n    },\n    // 根据class_id删除对应的班级信息\n    async removeClassById(classId) {\n      const confirmResult = await this.$confirm('此操作将永久删除该班级, 是否继续?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).catch(err => err);\n      // 如果用户确认删除，则返回值为字符串:confirm\n      // 如果用户取消了删除，则返回值为字符串:cancel\n      if (confirmResult === 'cancel') {\n        return this.$message.info('已取消删除');\n      }\n      if (confirmResult === 'confirm') {\n        // console.log(\"用户点击了确定按钮\")\n        this.delete.classId = classId;\n        this.request.post('/service-class/class', this.delete).then(res => {\n          if (res.code === '200') {\n            this.$message.success('删除成功！');\n            this.getUserList();\n          } else {\n            this.$message.error('删除失败！');\n          }\n        });\n      }\n    },\n    studentManage(classId, className) {\n      // console.log(\"向studentG传送数据\"+classId,className)\n      this.$router.push({\n        path: '/studentG',\n        query: {\n          classId: classId,\n          className: className\n        }\n      });\n    },\n    coursManage(classId, className) {\n      this.$router.push({\n        path: '/coursG',\n        query: {\n          classId: classId,\n          className: className\n        }\n      });\n    }\n  }\n};","map":{"version":3,"mappings":";AA6FA;EACAA;IACA;MACA;MACAC;QACA;QACAC;QACA;QACAC;QACAC;QACAC;QACAC;QACAC;MACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACA;MACAC;MACA;MACAC;QACAR;QACAS;QACAC;QACAZ;QACAG;MACA;MACA;MACAU;QACAX,YACA;UAAAY;UAAAC;UAAAC;QAAA;MAEA;MACA;MACAC;QACAf,YACA;UAAAY;UAAAC;UAAAC;QAAA;MAEA;MACA;MACAE;MACA;MACAC;QACAlB;QACAC;QACAF;QACAY;QACAT;MACA;MACAiB;QACAnB;QACAE;MACA;IACA;EACA;EACAkB,WAEA;EACAC;IACA;EACA;EACAC;IACAC;MACA;MACA;IACA;IACA;IACAC;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;QACA;QACA;QACA;UACAC;QACA;UACA;YACA;YACA;YACA;UACA;YACA;UACA;QACA;MACA;QACA;QACA;QACA;QACA;UACAA;QACA;UACA;YACA;YACA;YACA;YACA;cACA;cACA;cACA;gBACAA;cACA;gBACA;kBACA;kBACA;kBACA;kBACA;kBACA;kBACA;oBACA;kBACA;gBACA;kBACA;gBACA;cACA;YACA;cACA;cACA;gBACA;cACA;YACA;UACA;YACA;UACA;QACA;MACA;IACA;IACA;IACAC;MACA;MACA;MACA;IACA;IACA;IACAC;MACA;MACA;MACA;IACA;IACA;IACAC;MACA;IACA;IACA;IACAC;MACA;MACA;QACA;UACA;YACA;cACA;cACA;cACA;cACA;cACA;YACA;cACA;YACA;UACA;QACA;MACA;IACA;IACA;IACAC;MACA;MACA;MACA;MACA;MACA;IACA;IACA;IACAC;MACA;IACA;IACA;IACAC;MACA;QACA;UACA;YACA;cACA;cACA;cACA;cACA;cACA;YACA;cACA;YACA;UACA;QACA;MACA;IACA;IACA;IACA;MACA;QACAC;QACAC;QACAC;MACA;MACA;MACA;MACA;QACA;MACA;MACA;QACA;QACA;QACA;UACA;YACA;YACA;UACA;YACA;UACA;QACA;MACA;IACA;IACAC;MACA;MACA;QAAAC;QAAAC;UAAAtC;UAAAC;QAAA;MAAA;IACA;IACAsC;MACA;QAAAF;QAAAC;UAAAtC;UAAAC;QAAA;MAAA;IACA;EACA;AAEA","names":["data","queryInfo","pageNum","pageSize","teaId","classId","className","deleted","search","condition","user","classlist","total","addDialogVisible","addForm","teaName","classStudentNum","addFormRules","required","message","trigger","editFormRules","editDialogVisible","editForm","delete","mounted","created","methods","togetUserList","getUserList","params","handleSizeChange","handleCurrentChange","addDialogClosed","addClass","showEditDialog","editDialogClosed","editClassInfo","confirmButtonText","cancelButtonText","type","studentManage","path","query","coursManage"],"sourceRoot":"src/views/class","sources":["Classes.vue"],"sourcesContent":["<template>\r\n    <div>\r\n        \r\n        <!-- 搜索与添加区域 -->\r\n        <el-row :gutter=\"30\">\r\n            <el-col :span=\"5\">\r\n                <el-input placeholder=\"请输入内容\"\r\n                    v-model=\"condition\" clearable\r\n                    @clear=\"togetUserList\">\r\n                    <el-button slot=\"append\" icon=\"el-icon-search\"\r\n                    @click=\"getUserList\"></el-button>\r\n                </el-input>\r\n                </el-col>\r\n                <el-col :span=\"4\">\r\n                    <el-button type=\"primary\" @click=\"addDialogVisible = true\">添加班级</el-button>\r\n                </el-col>\r\n        </el-row>\r\n        <!-- 班级列表区域 -->\r\n        <el-table  :header-cell-style=\"{ backgroundColor: 'rgb(244, 244, 245)' }\" :data=\"classlist\" border stripe>\r\n            <el-table-column prop=\"classId\" label=\"班级id\"></el-table-column>\r\n            <el-table-column prop=\"className\" label=\"班级名称\"></el-table-column>\r\n            <el-table-column prop=\"teaName\" label=\"教师名称\"></el-table-column>\r\n            <el-table-column prop=\"classStudentNum\" label=\"班级人数\"></el-table-column>\r\n            <el-table-column prop=\"operation\" label=\"操作\" width=\"400\">\r\n            <template slot-scope=\"scope\">\r\n                <!-- 修改班级信息按钮 -->\r\n                <el-button type=\"primary\" icon=\"el-icon-edit\" @click=\"showEditDialog(scope.row.classId,scope.row.className)\"></el-button>\r\n                <!-- 分配学生按钮 -->\r\n                <el-tooltip effect=\"dark\" content=\"分配学生\" placement=\"top\" :enterable=\"false\">\r\n                    <el-button type=\"success\" icon=\"el-icon-s-custom\" @click=\"studentManage(scope.row.classId,scope.row.className)\"></el-button>\r\n                </el-tooltip>\r\n                <!-- 分配课程按钮 -->\r\n                <el-tooltip effect=\"dark\" content=\"分配课程\" placement=\"top\" :enterable=\"false\">\r\n                     <el-button type=\"warning\" icon=\"el-icon-reading\" @click=\"coursManage(scope.row.classId,scope.row.className)\"></el-button>\r\n                </el-tooltip>\r\n                <!-- 删除按钮 -->\r\n                <el-button type=\"danger\" icon=\"el-icon-delete\" @click=\"removeClassById(scope.row.classId)\"></el-button>\r\n                </template>\r\n            </el-table-column>\r\n        </el-table>\r\n        <!-- 分页区域 -->\r\n        <el-pagination\r\n            @size-change=\"handleSizeChange\"\r\n            @current-change=\"handleCurrentChange\"\r\n            :current-page=\"queryInfo.pageNum\"\r\n            :page-sizes=\"[6, 8, 10]\"\r\n            :page-size=\"queryInfo.pageSize\"\r\n            layout=\"total, sizes, prev, pager, next, jumper\"\r\n            :total=\"total\">\r\n        </el-pagination>\r\n        <!-- 添加班级的对话框 -->\r\n        <el-dialog\r\n            title=\"添加班级\"\r\n            :visible.sync=\"addDialogVisible\"\r\n            width=\"40%\" @close=\"addDialogClosed\">\r\n            <!-- 内容主体区域 -->\r\n            <el-form :model=\"addForm\" :rules=\"addFormRules\" ref=\"addFormRef\" label-width=\"80px\">\r\n                <el-form-item label=\"班级名称\" prop=\"className\">\r\n                    <el-input v-model=\"addForm.className\"></el-input>\r\n                </el-form-item>\r\n                <el-form-item label=\"教师名称\">\r\n                    <el-input v-model=\"addForm.teaName\" disabled></el-input>\r\n                </el-form-item>\r\n            </el-form>\r\n            <!-- 底部区域 -->\r\n            <span slot=\"footer\" class=\"dialog-footer\">\r\n                <el-button @click=\"addDialogVisible = false\">取 消</el-button>\r\n                <el-button type=\"primary\" @click=\"addClass\">确 定</el-button>\r\n            </span>\r\n        </el-dialog>\r\n\r\n        <!-- 修改班级的对话框 -->\r\n        <el-dialog\r\n            title=\"修改班级\"\r\n            :visible.sync=\"editDialogVisible\"\r\n            width=\"40%\" @close=\"editDialogClosed\">\r\n            <!-- 内容主体区域 -->\r\n            <el-form :model=\"editForm\" :rules=\"editFormRules\" ref=\"editFormRef\" label-width=\"80px\">\r\n                <el-form-item label=\"班级名称\" prop=\"className\">\r\n                    <el-input v-model=\"editForm.className\"></el-input>\r\n                </el-form-item>\r\n            </el-form>\r\n            <!-- 底部区域 -->\r\n            <span slot=\"footer\" class=\"dialog-footer\">\r\n                <el-button @click=\"editDialogVisible = false\">取 消</el-button>\r\n                <el-button type=\"primary\" @click=\"editClassInfo\">确 定</el-button>\r\n            </span>\r\n        </el-dialog>\r\n\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n    data() {\r\n        return {\r\n            //获取班级列表的参数对象\r\n            queryInfo: {\r\n                // 当前的页数\r\n                pageNum: 1,\r\n                // 当前每页显示多少条数据\r\n                pageSize: 6,\r\n                teaId: '',\r\n                classId: '',\r\n                className: '',\r\n                deleted: 0\r\n            },\r\n            search:'',\r\n            condition: '',\r\n            user: {},\r\n            classlist: [],\r\n            total: 0,\r\n            // 控制添加班级对话框的显示与隐藏\r\n            addDialogVisible: false,\r\n            // 添加班级的表单数据\r\n            addForm: {\r\n                className: '',\r\n                teaName: '',\r\n                classStudentNum: 0,\r\n                teaId: '',\r\n                deleted: 0\r\n            },\r\n            // 添加表单的验证规则对象\r\n            addFormRules: {\r\n                className: [\r\n                    { required: true, message: '请输入班级名称', trigger: 'blur' }\r\n                ]\r\n            },\r\n            // 修改表单的验证规则对象\r\n            editFormRules: {\r\n                className: [\r\n                    { required: true, message: '请输入班级名称', trigger: 'blur' }\r\n                ]\r\n            },\r\n            // 控制修改班级对话框的显示与隐藏\r\n            editDialogVisible: false,\r\n            // 查询到的班级信息对象\r\n            editForm: {\r\n                classId: '',\r\n                className: '',\r\n                teaId: '',\r\n                classStudentNum: 0,\r\n                deleted: 0\r\n            },\r\n            delete:{\r\n                classId:'',\r\n                deleted:1\r\n            }\r\n        }\r\n    },\r\n    mounted () {\r\n        \r\n    },\r\n    created() {\r\n        this.getUserList()\r\n    },\r\n    methods: {\r\n        togetUserList(){\r\n            this.condition = ''\r\n            this.getUserList()\r\n        },\r\n        //查询班级列表\r\n        getUserList() {\r\n            this.user = JSON.parse(localStorage.getItem(\"user\"));\r\n            // console.log(this.user);\r\n            this.queryInfo.teaId = parseInt(this.user.teaId)\r\n            this.addForm.teaId = this.user.teaId\r\n            this.editForm.teaId = this.user.teaId\r\n            this.addForm.teaName = this.user.truename\r\n            // console.log(this.addForm)\r\n            // console.log(\"condition\"+this.condition)\r\n            this.search = this.condition\r\n            if(this.search === ''){\r\n                this.queryInfo.classId = ''\r\n                this.queryInfo.className = ''\r\n                this.request.get('/service-class/class/page',{\r\n                    params : this.queryInfo\r\n                }).then(res =>{\r\n                    if(res.code === '200'){\r\n                        this.classlist = res.data.records\r\n                        // console.log(this.classlist)\r\n                        this.total = res.data.total\r\n                    }else{\r\n                        this.$message.error(\"获取班级列表失败！\")\r\n                    }\r\n                })\r\n            }else if(this.search !== ''){\r\n                this.queryInfo.classId = this.search\r\n                this.queryInfo.pageSize = 6\r\n                this.queryInfo.pageNum = 1\r\n                this.request.get('/service-class/class/page',{\r\n                    params : this.queryInfo\r\n                }).then(res =>{\r\n                    if(res.code === '200'){\r\n                        this.classlist = res.data.records\r\n                        // console.log(\"输入的搜索条件是classId\")\r\n                        // console.log(this.classlist)\r\n                        if(this.classlist.length === 0){\r\n                            this.queryInfo.classId = ''\r\n                            this.queryInfo.className = this.search\r\n                            this.request.get('/service-class/class/page',{\r\n                                params : this.queryInfo\r\n                            }).then(res =>{\r\n                                if(res.code === '200'){\r\n                                    // console.log(this.queryInfo,\"qu\")\r\n                                    this.classlist = res.data.records\r\n                                    // console.log(\"输入的搜索条件是className\")\r\n                                    // console.log(this.classlist)\r\n                                    this.total = res.data.total\r\n                                    if(this.classlist.length === 0){\r\n                                        this.$message.info(\"搜索结果为空！\")\r\n                                    }\r\n                                }else{\r\n                                    this.$message.error(\"获取班级列表失败！\")\r\n                                }\r\n                            })\r\n                        }else{\r\n                            this.total = res.data.total\r\n                            if(this.classlist.length === 0){\r\n                                this.$message.info(\"搜索结果为空！\")\r\n                            }\r\n                        }\r\n                    }else{\r\n                        this.$message.error(\"获取班级列表失败！\")\r\n                    }\r\n                })\r\n            }\r\n        },\r\n        // 监听pagesize改变的事件\r\n        handleSizeChange(newSize) {\r\n            // console.log(\"pageSize=\"+newSize)\r\n            this.queryInfo.pageSize = newSize\r\n            this.getUserList()\r\n        },\r\n        // 监听页码值改变的事件\r\n        handleCurrentChange(newPage) {\r\n            // console.log(\"pageNum=\"+newPage)\r\n            this.queryInfo.pageNum = newPage\r\n            this.getUserList()\r\n        },\r\n        // 监听添加班级对话框的关闭事件\r\n        addDialogClosed() {\r\n            this.$refs.addFormRef.resetFields()\r\n        },\r\n        // 点击按钮，添加新班级\r\n        addClass() {\r\n            // console.log(this.addForm)\r\n            this.$refs['addFormRef'].validate((valid) => {\r\n                if(valid){\r\n                    this.request.post(\"/service-class/class\",this.addForm).then(res =>{\r\n                        if(res.code === '200'){\r\n                            this.$message.success(\"新增班级成功！\")\r\n                            // 隐藏添加班级的对话框\r\n                            this.addDialogVisible = false\r\n                            // 重新获取班级列表数据\r\n                            this.getUserList()\r\n                        }else{\r\n                            this.$message.error(\"新增班级失败!\")\r\n                        }\r\n                    })\r\n                }\r\n            })\r\n        },\r\n        // 展示编辑班级的对话框\r\n       showEditDialog(classId,className) {\r\n            this.editDialogVisible = true\r\n            this.editForm.className = className\r\n            this.editForm.classId = classId\r\n            // console.log(this.editForm)\r\n            this.editDialogVisible = true\r\n        },\r\n        // 监听修改班级对话框的关闭事件\r\n        editDialogClosed() {\r\n            this.$refs.editFormRef.resetFields()\r\n        },\r\n        // 修改信息并提交\r\n        editClassInfo() {\r\n            this.$refs['editFormRef'].validate((valid) => {\r\n                if(valid){\r\n                    this.request.post(\"/service-class/class\",this.editForm).then(res =>{\r\n                        if(res.code === '200'){\r\n                            this.$message.success(\"修改班级成功！\")\r\n                            // 隐藏修改班级的对话框\r\n                            this.editDialogVisible = false\r\n                            // 重新获取班级列表数据\r\n                            this.getUserList()\r\n                        }else{\r\n                            this.$message.error(\"修改班级失败!\")\r\n                        }\r\n                    })\r\n                }\r\n            })\r\n        },\r\n        // 根据class_id删除对应的班级信息\r\n        async removeClassById(classId) {\r\n            const confirmResult = await this.$confirm('此操作将永久删除该班级, 是否继续?', '提示', {\r\n                confirmButtonText: '确定',\r\n                cancelButtonText: '取消',\r\n                type: 'warning'\r\n            }).catch(err => err)\r\n            // 如果用户确认删除，则返回值为字符串:confirm\r\n            // 如果用户取消了删除，则返回值为字符串:cancel\r\n            if(confirmResult === 'cancel') {\r\n                return this.$message.info('已取消删除')\r\n            }\r\n            if(confirmResult === 'confirm'){\r\n                // console.log(\"用户点击了确定按钮\")\r\n                this.delete.classId = classId\r\n                this.request.post('/service-class/class',this.delete).then(res =>{\r\n                    if(res.code === '200'){\r\n                        this.$message.success('删除成功！')\r\n                        this.getUserList()\r\n                    }else{\r\n                         this.$message.error('删除失败！')\r\n                    }\r\n                })\r\n            }\r\n        },\r\n        studentManage(classId,className) {\r\n            // console.log(\"向studentG传送数据\"+classId,className)\r\n            this.$router.push({path: '/studentG',query:{classId:classId,className:className}})\r\n        },\r\n        coursManage(classId,className) {\r\n            this.$router.push({path: '/coursG',query:{classId:classId,className:className}})\r\n        }\r\n    }\r\n\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.el-row{\r\n    margin-top: -10px;\r\n}\r\n.el-table{\r\n    margin-top: 20px;\r\n}\r\n.el-pagination{\r\n    margin-top: 20px;\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}