{"ast":null,"code":"export default {\n  data() {\n    return {\n      icon: 'el-icon-star-off',\n      //点赞图标\n      infoLikeOn: '',\n      //点赞图标样式\n      likeNum: 0,\n      pageNum: 1,\n      //页码\n      pageSize: 100,\n      //每页显示多少条数据\n      total: 0,\n      consultData: {},\n      //咨询数据\n      commentData: [],\n      //评论数据\n      deliverConsult: '',\n      //发布评论输入框\n      user: JSON.parse(localStorage.getItem('user'))\n    };\n  },\n  created() {\n    this.consultData = JSON.parse(this.$route.query.consultData); //获取从咨询管理传过来的     \n    this.load();\n    //console.log(this.consultData)\n    // console.log(this.infoLike,'this.infoLike')\n  },\n\n  methods: {\n    //点赞\n    like() {\n      //点赞\n      if (this.icon !== 'el-icon-star-on') {\n        this.icon = 'el-icon-star-on';\n        this.infoLikeOn = 'info-like-on';\n        const info_like = this.consultData.infoLike * 1 + 1;\n        this.request.post(\"/service-information/information\", {\n          infoId: this.consultData.infoId,\n          infoLike: info_like\n        }).then(res => {\n          if (res.code === '200') {\n            this.$message.success(\"点赞成功！\");\n            this.load();\n          } else {\n            this.$message.info(\"点赞失败！\");\n          }\n        });\n      } else {\n        //取消点赞\n        this.icon = 'el-icon-star-off';\n        this.infoLikeOn = '';\n        const info_like = this.consultData.infoLike * 1 - 1;\n        this.request.post(\"/service-information/information\", {\n          infoId: this.consultData.infoId,\n          infoLike: info_like\n        }).then(res => {\n          if (res.code === '200') {\n            this.$message.success(\"取消点赞！\");\n            this.load();\n          } else {\n            this.$message.info(\"取消点赞失败！\");\n          }\n        });\n      }\n    },\n    load() {\n      console.log(this.consultData.infoId, 'this.consultData.infoId');\n      this.request.get(\"/service-comment/comment/commentPage\", {\n        params: {\n          infoId: this.consultData.infoId,\n          pageSize: this.pageSize,\n          pageNum: this.pageNum\n        }\n      }).then(res => {\n        console.log(res, 'commentData');\n        this.commentData = res.data.records;\n        this.total = res.data.total;\n      });\n    },\n    //每页显示多少条数据\n    handleSizeChange(pageSize) {\n      // console.log(pageSize)\n      this.pageSize = pageSize;\n      this.load();\n    },\n    //页码\n    handleCurrentChange(pageNum) {\n      // console.log(pageNum)\n      this.pageNum = pageNum;\n      this.load();\n    },\n    //新增评论\n    add() {\n      this.request.post('/service-comment/comment', {\n        infoId: this.consultData.infoId,\n        uid: this.user.id,\n        role: 0,\n        ccontent: this.deliverConsult\n      }).then(res => {\n        console.log(res, 'res');\n        this.load();\n        this.deliverConsult = '';\n        this.$message.success(\"发布成功！！\");\n      });\n    }\n  }\n};","map":{"version":3,"mappings":"AAsEA;EACAA;IACA;MACAC;MAAA;MACAC;MAAA;MACAC;MACAC;MAAA;MACAC;MAAA;MACAC;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;IACA;EACA;EACAC;IACA;IACA;IACA;IACA;EACA;;EACAC;IACA;IACAC;MACA;MACA;QACA;QACA;QACA;QACA;UACAC;UACAC;QACA;UACA;YACA;YACA;UACA;YACA;UACA;QACA;MAEA;QAAA;QACA;QACA;QACA;QACA;UACAD;UACAC;QACA;UACA;YACA;YACA;UACA;YACA;UACA;QACA;MACA;IACA;IACAC;MACAC;MACA;QACAC;UACAJ;UACAT;UACAD;QACA;MACA;QACAa;QACA;QACA;MACA;IACA;IACA;IACAE;MACA;MACA;MACA;IACA;IACA;IACAC;MACA;MACA;MACA;IACA;IACA;IACAC;MACA;QACAP;QACAQ;QACAC;QACAC;MACA;QACAP;QACA;QACA;QACA;MACA;IACA;EACA;AACA","names":["data","icon","infoLikeOn","likeNum","pageNum","pageSize","total","consultData","commentData","deliverConsult","user","created","methods","like","infoId","infoLike","load","console","params","handleSizeChange","handleCurrentChange","add","uid","role","ccontent"],"sourceRoot":"src/views/Find","sources":["ConsultDetial.vue"],"sourcesContent":["<template>\r\n    <div >\r\n        <!-- 返回咨询页面 -->\r\n        <p class=\"returnConsult\" @click=\"$router.push('/find')\">\r\n            <i class=\"el-icon-back\"></i>  返回\r\n        </p>\r\n\r\n        <!-- 咨询详情 -->\r\n        <div class=\"consult\">\r\n            <div class=\"consult-top\">\r\n                <!-- 标题 -->\r\n                <h3> {{consultData.infoTitle}}</h3>\r\n                <!-- 作者 -->\r\n                <span >{{consultData.infoAuthor}}</span>\r\n                <!-- 发布日期 -->\r\n                <span style=\"margin-left: 20px;\">{{consultData.infoData}}</span>   \r\n            </div>\r\n            <!-- 咨询内容 -->\r\n            <div  v-html=\"consultData.infoMain\"></div>    \r\n        </div> \r\n\r\n        <!-- 评论 -->\r\n        <div class=\"comment\" >\r\n           <!-- 发布评论 -->\r\n            <div class=\"deliverConsult\">\r\n                <el-form>\r\n                    <el-input  size=\"medium\" v-model=\"deliverConsult\" placeholder=\"请输入评论\"></el-input>\r\n                    <el-button size=\"medium\"  type=\"primary\" @click=\"add\">发布</el-button>\r\n                </el-form>\r\n            </div>\r\n            <p>全部评论</p>\r\n            <el-empty  v-if=\"commentData.length === 0\" description=\"暂无评论\"></el-empty>\r\n            <div class=\"comment-content\" v-else v-for=\"item in commentData\" :key=\"item.index\">\r\n                <div class=\"commen-content-top\">\r\n                    <div class=\"img\">\r\n                        <el-avatar :src=\"item.avatar\" ></el-avatar>\r\n                    </div>\r\n                    <div class=\"text\">\r\n                        <p>{{item.truename}}</p>\r\n                        <p class=\"time\" >{{item.cDate}}</p>\r\n                    </div>\r\n                </div>\r\n                <!-- 评论内容 -->\r\n                <div class=\"comment-content-bottom\">\r\n                    <p>{{item.ccontent}}</p>\r\n                </div>\r\n            </div>   \r\n            <!-- 分页 -->\r\n            <!-- <div v-if=\"commentData.length !== 0\" class=\"block\">\r\n                <el-pagination\r\n                @size-change=\"handleSizeChange\"\r\n                @current-change=\"handleCurrentChange\"\r\n                :current-page.=\"pageNum\"\r\n                :page-sizes=\"[7, 10, 13]\"\r\n                :page-size=\"pageSize\"\r\n                layout=\" total, sizes, prev, pager, next, jumper\"\r\n                :total=\"total\"\r\n                >\r\n                </el-pagination>\r\n            </div>         -->\r\n        </div>\r\n       \r\n        <!-- 点赞按钮 -->\r\n        <el-tooltip class=\"item\" effect=\"light\" content=\"点赞\" placement=\"top\">\r\n            <el-button  class=\"info-like \" :class=\"infoLikeOn\" :icon=\"icon\" @click=\"like\" circle></el-button>\r\n        </el-tooltip>\r\n        \r\n    </div>\r\n</template>\r\n<script>\r\nexport default{\r\n    data () {\r\n        return {\r\n            icon: 'el-icon-star-off', //点赞图标\r\n            infoLikeOn: '',//点赞图标样式\r\n            likeNum: 0,\r\n            pageNum: 1,//页码\r\n            pageSize: 100,//每页显示多少条数据\r\n            total: 0,\r\n            consultData: {},//咨询数据\r\n            commentData: [],//评论数据\r\n            deliverConsult: '',//发布评论输入框\r\n            user: JSON.parse(localStorage.getItem('user'))\r\n        }\r\n    },\r\n    created () {   \r\n        this.consultData = JSON.parse(this.$route.query.consultData); //获取从咨询管理传过来的     \r\n        this.load() \r\n        //console.log(this.consultData)\r\n        // console.log(this.infoLike,'this.infoLike')\r\n    },\r\n    methods: {\r\n        //点赞\r\n        like(){\r\n            //点赞\r\n            if(this.icon !== 'el-icon-star-on'){\r\n                this.icon = 'el-icon-star-on'\r\n                this.infoLikeOn = 'info-like-on'\r\n                const info_like = this.consultData.infoLike * 1 + 1\r\n                this.request.post(\"/service-information/information\",{\r\n                    infoId: this.consultData.infoId,\r\n                    infoLike: info_like\r\n                }).then(res => {\r\n                    if(res.code === '200'){\r\n                        this.$message.success(\"点赞成功！\")\r\n                        this.load()\r\n                    }else{\r\n                        this.$message.info(\"点赞失败！\")\r\n                    }                      \r\n                })\r\n\r\n            }else{//取消点赞\r\n                this.icon = 'el-icon-star-off'\r\n                this.infoLikeOn = ''\r\n                const info_like = this.consultData.infoLike * 1 - 1\r\n                this.request.post(\"/service-information/information\",{\r\n                    infoId: this.consultData.infoId,\r\n                    infoLike: info_like\r\n                }).then(res => {\r\n                    if(res.code === '200'){\r\n                        this.$message.success(\"取消点赞！\")\r\n                        this.load()\r\n                    }else{\r\n                        this.$message.info(\"取消点赞失败！\")\r\n                    }                      \r\n                })          \r\n            }\r\n        },\r\n        load(){\r\n            console.log(this.consultData.infoId,'this.consultData.infoId')\r\n           this.request.get(\"/service-comment/comment/commentPage\",{\r\n            params:{\r\n                infoId: this.consultData.infoId,\r\n                pageSize: this.pageSize,\r\n                pageNum: this.pageNum,\r\n            }\r\n           }).then(res => {\r\n                console.log(res,'commentData')\r\n                this.commentData = res.data.records\r\n                this.total = res.data.total\r\n           })\r\n        },\r\n        //每页显示多少条数据\r\n        handleSizeChange(pageSize){\r\n            // console.log(pageSize)\r\n            this.pageSize = pageSize\r\n            this.load()\r\n        },\r\n        //页码\r\n        handleCurrentChange(pageNum){\r\n            // console.log(pageNum)\r\n            this.pageNum = pageNum\r\n            this.load()\r\n        },\r\n        //新增评论\r\n        add(){\r\n            this.request.post('/service-comment/comment',{\r\n                infoId: this.consultData.infoId,\r\n                uid: this.user.id,\r\n                role: 0,\r\n                ccontent: this.deliverConsult               \r\n            }).then(res => {\r\n                console.log(res, 'res')\r\n                this.load()\r\n                this.deliverConsult = ''\r\n                this.$message.success(\"发布成功！！\")\r\n            })\r\n        }\r\n    }\r\n}\r\n</script>\r\n<style lang=\"less\" scoped>\r\n//点赞按钮\r\n.info-like{\r\n    position: fixed;\r\n    top: 550px;\r\n    right: 10%;\r\n    width: 50px;\r\n    height: 50px;\r\n    box-shadow: 0 2px 4px rgba(0, 0, 0, .12), 0 0 6px rgba(0, 0, 0, .04);\r\n    font-size: 30px;\r\n \r\n}\r\n.info-like-on{\r\n    color: #d8ea89;\r\n}\r\n.returnConsult{\r\n    cursor: pointer;\r\n    margin-left: 20px;\r\n}\r\n//咨询详情\r\n.consult{\r\n    width: 60%;\r\n    box-shadow: 0 0 3px #cac6c6;\r\n    margin: auto;\r\n    padding: 20px 20px 20px 20px;\r\n    .consult-top{\r\n        height: 65px;\r\n        border-bottom: 2px solid #f0f0f0;\r\n        h3{\r\n            margin-bottom: 10px;\r\n        }\r\n        span{\r\n            color:rgb(170, 170, 170);\r\n            font-size: 14px;\r\n        }\r\n    }\r\n\r\n}\r\n\r\n//评论\r\n.comment{\r\n    width: 60%;\r\n    box-shadow: 0 0 3px #cac6c6;\r\n    margin: auto;\r\n    padding: 20px 20px 20px 20px;\r\n    margin-top: 20px;\r\n    //发布评论\r\n    .deliverConsult{\r\n        .el-input{\r\n            width: 88%;\r\n            margin-right:20px ;\r\n            padding: 0;\r\n        }\r\n    }\r\n    .comment-content{\r\n        margin-bottom: 10px;\r\n        border-bottom: 2px solid #f0f0f0;\r\n        .commen-content-top{\r\n            height: 70px;\r\n            display: flex;\r\n            align-items: center;\r\n            .img .el-avatar{\r\n                width: 70px;\r\n                height: 70px;\r\n            }\r\n            .text{\r\n                border: none;\r\n                min-height: 0;\r\n                margin-left: 20px;\r\n                p{\r\n                    color: #E6A23C;\r\n                }\r\n                .time{\r\n                    color:rgb(170, 170, 170);\r\n                    font-size: 14px;\r\n                    \r\n                }\r\n            }\r\n        }\r\n        .comment-content-bottom{\r\n            margin-top: 10px;\r\n            p{\r\n                margin: 0px 10px 10px 90px;\r\n            }\r\n        }\r\n    }\r\n    \r\n}\r\n\r\n</style>"]},"metadata":{},"sourceType":"module"}