{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport Editor from '@/components/Editor.vue';\nexport default {\n  components: {\n    Editor\n  },\n  data() {\n    return {\n      pageNum: 1,\n      //页码\n      pageSize: 100,\n      //每页显示多少条数据\n      total: 0,\n      //总条数\n      consultTitle: '',\n      //搜索框-标题\n      consultAuthor: '',\n      //搜索框-作者\n      consultData: [],\n      dialogVisibleAdd: false,\n      form: {},\n      isClear: false,\n      user: JSON.parse(localStorage.getItem('user')),\n      // detail:\"\",//输入咨询内容\n      rules: {\n        infoTitle: [{\n          required: true,\n          message: '请输入标题',\n          trigger: 'blur'\n        }]\n      }\n    };\n  },\n  mounted() {},\n  created() {\n    this.load();\n  },\n  methods: {\n    load() {\n      this.request.get(\"/service-information/information/page\", {\n        params: {\n          infoTitle: this.consultTitle,\n          infoAuthor: this.consultAuthor,\n          pageSize: this.pageSize,\n          pageNum: this.pageNum\n        }\n      }).then(res => {\n        console.log(res);\n        this.consultData = res.data.records;\n        this.total = res.data.total;\n        this.form = {}; //清空新增咨询弹窗\n        //console.log(res.data.records[0].infoMain,res.data.total)\n        //this.tableData = res.data\n      });\n    },\n\n    //每页显示多少条数据\n    handleSizeChange(pageSize) {\n      // console.log(pageSize)\n      this.pageSize = pageSize;\n      this.load();\n    },\n    //页码\n    handleCurrentChange(pageNum) {\n      // console.log(pageNum)\n      this.pageNum = pageNum;\n      this.load();\n    },\n    //刷新按钮\n    reast() {\n      this.consultAuthor = '';\n      this.consultTitle = '';\n      this.load();\n    },\n    //发布咨询\n    addConsult() {\n      this.dialogVisibleAdd = true;\n    },\n    //新增咨询弹窗确定按钮\n    saveConsult() {\n      this.$refs['consultFrom'].validate(valid => {\n        //this.form.infoAuthor = this.user.truename\n        this.form.uid = this.user.id;\n        console.log(this.form, 'this.form');\n        if (valid && this.form.infoMain !== '') {\n          this.dialogVisibleAdd = false;\n          this.request.post(\"/service-information/information\", this.form).then(res => {\n            //console.log(res,'zx-res')\n            if (res.code === '200') {\n              this.$message.success(\"发布成功！\");\n              this.load();\n            } else {\n              this.$message.error(\"发布失败！\");\n            }\n          });\n        } else {\n          this.$message.info(\"正文不能为空\");\n        }\n      });\n    },\n    //新增咨询弹窗取消按钮\n    cencal() {\n      this.dialogVisibleAdd = false;\n      this.form = {};\n    },\n    change(val) {\n      //   console.log(val,'val')\n    },\n    //跳转到咨询详情页面\n    read(item) {\n      console.log(ite, 'item');\n      this.$router.push({\n        path: '/consultDetial',\n        query: {\n          consultData: JSON.stringify(item)\n        }\n      });\n    },\n    //修改咨询\n    editConsult(item) {\n      if (this.user.truename == item.infoAuthor) {\n        this.dialogVisibleAdd = true;\n        this.form = item;\n      } else {\n        this.$message.info(\"这条咨询不是您创建的，您没有权限修改！\");\n      }\n    },\n    //删除咨询\n    deleteCourse(item) {\n      if (this.user.truename == item.infoAuthor) {\n        this.$confirm('此操作将永久删除该文件, 是否继续?', '提示', {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          type: 'warning'\n        }).then(() => {\n          this.request.delete(\"/service-information/information/\" + item.infoId).then(res => {\n            //console.log(res,'delete-res')\n            if (res.code === '200') {\n              this.$message.success(\"删除成功！\");\n              this.load();\n            } else {\n              this.$message.error(\"删除失败！\");\n            }\n          });\n        }).catch(() => {\n          this.$message.info(\"已取消删除\");\n        });\n      } else {\n        this.$message.info(\"这条咨询不是您创建的，您没有权限删除！\");\n      }\n    }\n  }\n};","map":{"version":3,"mappings":";AA8EA;AACA;EACAA;IACAC;EAEA;EACAC;IACA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MACAC;MACAC;MACAC;MACAC;MACA;MACAC;QACAC,YACA;UAAAC;UAAAC;UAAAC;QAAA;MAEA;IACA;EACA;EAEAC,WAEA;EACAC;IACA;EAEA;EACAC;IACAC;MACA;QACAC;UACAR;UACAS;UACAnB;UACAD;QACA;MACA;QACAqB;QACA;QACA;QACA;QACA;QACA;MAEA;IACA;;IACA;IACAC;MACA;MACA;MACA;IACA;IACA;IACAC;MACA;MACA;MACA;IACA;IACA;IACAC;MACA;MACA;MACA;IACA;IACA;IACAC;MACA;IACA;IACA;IACAC;MACA;QACA;QACA;QACAL;QACA;UACA;UACA;YACA;YACA;cACA;cACA;YACA;cACA;YACA;UACA;QACA;UACA;QACA;MACA;IACA;IACA;IACAM;MACA;MACA;IACA;IACAC;MACA;IACA;IACA;IACAC;MACAR;MACA;QACAS;QACAC;UACA1B;QACA;MACA;IACA;IACA;IACA2B;MACA;QACA;QACA;MACA;QACA;MACA;IACA;IACA;IACAC;MACA;QACA;UACAC;UACAC;UACAC;QACA;UACA;YACA;YACA;cACA;cACA;YACA;cACA;YACA;UACA;QACA;UACA;QACA;MAGA;QACA;MACA;IACA;EAGA;AAEA","names":["components","Editor","data","pageNum","pageSize","total","consultTitle","consultAuthor","consultData","dialogVisibleAdd","form","isClear","user","rules","infoTitle","required","message","trigger","mounted","created","methods","load","params","infoAuthor","console","handleSizeChange","handleCurrentChange","reast","addConsult","saveConsult","cencal","change","read","path","query","editConsult","deleteCourse","confirmButtonText","cancelButtonText","type"],"sourceRoot":"src/components/find","sources":["Consult.vue"],"sourcesContent":["<template>\r\n    <div style=\"margin-bottom: 10px;\">\r\n        <div class=\"addConsult\">\r\n            <!-- 搜索 -->\r\n            <el-input size=\"mini\" style=\"width: 200px\" suffix-icon=\"el-icon-search\" placeholder=\"请输入作者\" v-model=\"consultAuthor\" @clear=\"load\" clearable></el-input>\r\n            <el-input size=\"mini\" style=\"width: 200px; margin-left: 10px\" suffix-icon=\"el-icon-search\" placeholder=\"请输入标题\" v-model=\"consultTitle\"  @clear=\"load\" clearable></el-input>\r\n            <el-button size=\"mini\" style=\"margin-left: 10px\" type=\"primary\" @click=\"load\">搜索</el-button>\r\n             <!-- 刷新按钮 -->\r\n           <el-button size=\"mini\" style=\"margin-left: 10px\" type=\"primary\" @click=\"reast\"><i class=\"el-icon-refresh\"></i></el-button> \r\n            <!-- 新增课程按钮 -->\r\n            <el-button type=\"primary\" @click=\"addConsult\">发布 <i class=\"el-icon-circle-plus-outline\"></i></el-button>\r\n        </div>\r\n\r\n        <div class=\"consult\">\r\n            <!-- 咨询列表 -->\r\n            <div class=\"consult-box\" v-for=\"item in consultData\" :key=\"item.infoId\">\r\n                <!-- 咨询内容 -->\r\n                <div class=\"consult-box-left\">\r\n                    <p class=\"title\">{{ item.infoTitle }}</p>\r\n                    <div class=\"consult-content\"   v-html=\"item.infoMain\">\r\n                        <!-- {{ item.infoMain }} -->\r\n                    </div>\r\n                    <p class=\"author\"  >\r\n                        <span>{{ item.infoAuthor }}</span>\r\n                        <span>点赞数： {{ item.infoLike}}</span>\r\n                        <span>{{ item.infoData }}</span>\r\n                    </p>\r\n                </div>\r\n                <!-- 按钮 -->\r\n                <div class=\"consult-box-right\">\r\n                    <el-button type=\"success\" icon=\"el-icon-view\" @click=\"$router.push(\r\n                        {\r\n                            path: '/consultDetial',\r\n                            query: {\r\n                                consultData: JSON.stringify(item)\r\n                            }\r\n                        }\r\n                        )\" circle></el-button>\r\n                    <el-button type=\"primary\" icon=\"el-icon-edit\" @click=\"editConsult(item)\" circle></el-button>                    \r\n                    <el-button size=\"mini\"  type=\"danger\" icon=\"el-icon-delete\" @click=\"deleteCourse(item)\" circle></el-button>\r\n                                                     \r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <!-- 分页 -->\r\n        <!-- <div class=\"block\">\r\n            <el-pagination\r\n            @size-change=\"handleSizeChange\"\r\n            @current-change=\"handleCurrentChange\"\r\n            :current-page.=\"pageNum\"\r\n            :page-sizes=\"[7, 10, 13]\"\r\n            :page-size=\"pageSize\"\r\n            layout=\" total, sizes,   prev,  pager, next, jumper\"\r\n            :total=\"total\">\r\n            </el-pagination>\r\n        </div> -->\r\n\r\n        <!-- 发布咨询弹窗 -->\r\n        <el-dialog title=\"咨询\" :visible.sync=\"dialogVisibleAdd\" width=\"70%\" center>\r\n            <el-form ref=\"consultFrom\" :rules=\"rules\" :inline=\"true\" :model=\"form\">\r\n                <el-form-item label=\"标题\" prop=\"infoTitle\">\r\n                    <el-input v-model=\"form.infoTitle\" placeholder=\"请输入标题\"></el-input>\r\n                </el-form-item>\r\n                <el-form-item >\r\n                    <el-input type=\"hidden\" v-model=\"form.infoAuthor = user.truename \" ></el-input>\r\n                </el-form-item>\r\n                <Editor v-model=\"form.infoMain\" :isClear=\"isClear\" @change=\"change\"></Editor>\r\n            </el-form>\r\n            <span slot=\"footer\" class=\"dialog-footer\">\r\n                <el-button @click=\"cencal\">取 消</el-button>\r\n                <el-button type=\"primary\" @click=\"saveConsult\">发 布</el-button>\r\n            </span>\r\n        </el-dialog>\r\n    </div>\r\n\r\n</template>\r\n<script>\r\nimport Editor from '@/components/Editor.vue'\r\nexport default {\r\n    components: {\r\n        Editor,\r\n     \r\n    },\r\n    data() {\r\n        return {\r\n            pageNum: 1,//页码\r\n            pageSize: 100,//每页显示多少条数据\r\n            total: 0,//总条数\r\n            consultTitle: '',//搜索框-标题\r\n            consultAuthor: '',//搜索框-作者\r\n            consultData: [],\r\n            dialogVisibleAdd: false,\r\n            form: {},\r\n            isClear: false,\r\n            user: JSON.parse(localStorage.getItem('user')),\r\n            // detail:\"\",//输入咨询内容\r\n            rules: {\r\n                infoTitle: [\r\n                    { required: true, message: '请输入标题', trigger: 'blur' },\r\n                ],\r\n            }\r\n        }\r\n    },\r\n   \r\n    mounted() {\r\n        \r\n    },\r\n    created () {\r\n        this.load()\r\n       \r\n    },\r\n    methods: {        \r\n        load(){\r\n            this.request.get(\"/service-information/information/page\",{\r\n               params: {\r\n                   infoTitle: this.consultTitle,\r\n                   infoAuthor: this.consultAuthor,\r\n                   pageSize: this.pageSize,\r\n                   pageNum: this.pageNum,\r\n               }\r\n           }).then(res => {\r\n                console.log(res)\r\n                this.consultData = res.data.records\r\n                this.total = res.data.total\r\n                this.form = {} //清空新增咨询弹窗\r\n                //console.log(res.data.records[0].infoMain,res.data.total)\r\n               //this.tableData = res.data\r\n               \r\n           })\r\n        },\r\n        //每页显示多少条数据\r\n        handleSizeChange(pageSize){\r\n           // console.log(pageSize)\r\n           this.pageSize = pageSize\r\n           this.load()\r\n       },\r\n        //页码\r\n        handleCurrentChange(pageNum){\r\n            // console.log(pageNum)\r\n            this.pageNum = pageNum\r\n            this.load()\r\n        },\r\n        //刷新按钮\r\n        reast(){\r\n            this.consultAuthor = ''\r\n            this.consultTitle = ''\r\n            this.load()\r\n        },\r\n        //发布咨询\r\n        addConsult() {\r\n            this.dialogVisibleAdd = true;\r\n        },\r\n        //新增咨询弹窗确定按钮\r\n        saveConsult() {\r\n            this.$refs['consultFrom'].validate((valid) => {\r\n                //this.form.infoAuthor = this.user.truename\r\n                this.form.uid = this.user.id\r\n                console.log(this.form,'this.form')\r\n                if (valid && this.form.infoMain !== '') {\r\n                    this.dialogVisibleAdd = false;\r\n                    this.request.post(\"/service-information/information\",this.form).then(res => {\r\n                        //console.log(res,'zx-res')\r\n                        if(res.code === '200'){\r\n                            this.$message.success(\"发布成功！\")\r\n                            this.load()\r\n                        }else{\r\n                            this.$message.error(\"发布失败！\")\r\n                        }                      \r\n                    })\r\n                } else {\r\n                    this.$message.info(\"正文不能为空\")\r\n                }\r\n            })\r\n        },\r\n         //新增咨询弹窗取消按钮\r\n        cencal(){\r\n            this.dialogVisibleAdd = false;\r\n            this.form = {}\r\n        },\r\n        change(val) {\r\n            //   console.log(val,'val')\r\n        },\r\n        //跳转到咨询详情页面\r\n        read(item){\r\n            console.log(ite,'item')\r\n            this.$router.push({\r\n                path: '/consultDetial',\r\n                query: {\r\n                        consultData: JSON.stringify(item)\r\n                    }\r\n            })\r\n        },\r\n        //修改咨询\r\n        editConsult(item){     \r\n            if(this.user.truename == item.infoAuthor){\r\n                this.dialogVisibleAdd = true\r\n                this.form = item\r\n            }else{\r\n                this.$message.info(\"这条咨询不是您创建的，您没有权限修改！\")\r\n            }         \r\n        },\r\n        //删除咨询\r\n        deleteCourse(item){\r\n            if (this.user.truename == item.infoAuthor) {\r\n                this.$confirm('此操作将永久删除该文件, 是否继续?', '提示', {\r\n                    confirmButtonText: '确定',\r\n                    cancelButtonText: '取消',\r\n                    type: 'warning'\r\n                }).then(() => {\r\n                    this.request.delete(\"/service-information/information/\"+item.infoId).then(res => {\r\n                    //console.log(res,'delete-res')\r\n                    if(res.code === '200'){\r\n                        this.$message.success(\"删除成功！\")\r\n                        this.load()\r\n                    }else{\r\n                        this.$message.error(\"删除失败！\")\r\n                    }\r\n                })\r\n                }).catch(() => {\r\n                    this.$message.info(\"已取消删除\")     \r\n                });\r\n             \r\n                \r\n            }else{\r\n                this.$message.info(\"这条咨询不是您创建的，您没有权限删除！\")\r\n            }      \r\n        }\r\n\r\n\r\n    },\r\n    \r\n}\r\n</script>\r\n<style lang=\"less\" scoped>\r\n.addConsult{\r\n    width: 95%;\r\n    margin: auto;\r\n    margin-bottom: 20px;\r\n}\r\n//分页\r\n.block{\r\n    margin-top: 10px;\r\n    margin-left: 40px;\r\n}\r\n.consult {\r\n    width: 90%;\r\n    border-radius: 10px;\r\n    box-shadow: 0 0 3px #cac6c6;\r\n    margin: auto;\r\n    padding: 5px 20px 20px 20px;\r\n    position: relative;\r\n\r\n    .addbtn {\r\n        position: absolute;\r\n        left: -70px;\r\n        top: 0px;\r\n        width: 50px;\r\n        height: 50px;\r\n        box-shadow: 0 4px 10px 0 rgba(162, 169, 210, 0.1);\r\n\r\n    }\r\n\r\n    .consult-box {\r\n        display: flex;\r\n        border-bottom: 2px solid #f0f0f0;\r\n        margin-top: 10px;\r\n        .consult-box-left {\r\n            width: 90%;\r\n            border-right: 2px solid #f0f0f0;\r\n            padding-right: 20px;\r\n            margin-bottom: 10px;\r\n            margin-top: 10px;\r\n            .consult-content{\r\n                \r\n                display: -webkit-box;\r\n                -webkit-box-orient: vertical;\r\n                -webkit-line-clamp: 2;\r\n                overflow: hidden;\r\n                color: rgb(82, 80, 80);\r\n                margin-bottom: 10px;\r\n            }\r\n\r\n            .title {\r\n                font-size: 25px;\r\n                margin: 0;\r\n            }\r\n\r\n            .content {\r\n                display: -webkit-box;\r\n                -webkit-box-orient: vertical;\r\n                -webkit-line-clamp: 2;\r\n                overflow: hidden;\r\n                color: rgb(82, 80, 80);\r\n            }\r\n\r\n            .author {\r\n                display: flex;\r\n                justify-content: space-between;\r\n                color: rgb(170, 170, 170);\r\n                font-size: 15px;\r\n                margin: 0;\r\n               \r\n            }\r\n            .authors{\r\n                position: relative;\r\n                top:25px;\r\n            }\r\n        }\r\n\r\n        .consult-box-right {\r\n            width: 7%;\r\n            display: flex;\r\n            align-items: center;\r\n            justify-content: center;\r\n            flex-direction: column;\r\n            .el-button {\r\n                width: 30px;\r\n                height: 30px;\r\n                margin: 3px;\r\n            }\r\n\r\n        }\r\n\r\n    }\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}