{"ast":null,"code":"export default {\n  data() {\n    return {\n      //获取班级-学生列表的参数对象\n      queryInfo: {\n        classId: '',\n        // 当前的页数\n        pageNum: 1,\n        // 当当前每页显示多少条数据\n        pageSize: 6,\n        stuId: '',\n        stuName: ''\n      },\n      condition: '',\n      DXcondition: '',\n      search: '',\n      studentlist: [],\n      total: 0,\n      DXtotal: 0,\n      // 控制添加班级-学生对话框的显示与隐藏\n      addDialogVisible: false,\n      //学习进度弹框\n      studyDialogVisible: false,\n      stuName: '',\n      studyTableData: [],\n      // 添加班级-学生的表单数据\n      addForm: {\n        stuName: ''\n      },\n      // 添加表单的验证规则对象\n      addFormRules: {\n        stuName: [{\n          required: true,\n          message: '请输入学生姓名',\n          trigger: 'blur'\n        }]\n      },\n      restaurants: [],\n      timeout: null,\n      classIN: {\n        classId: '',\n        className: ''\n      },\n      queryfindStudent: {\n        stuName: '',\n        classId: '',\n        pageSize: 3,\n        pageNum: 1\n      },\n      findStudent: [],\n      findStudentOb: [],\n      Stuitem: {\n        classId: ''\n        // stuId: ''\n      },\n\n      tableData: [],\n      multipleSelection: [],\n      allCourseLength: 0,\n      allCourse: [],\n      progress: ''\n    };\n  },\n  created() {\n    const classIN = this.$route.query;\n    // console.log(classIN);\n    if (classIN) {\n      // var 参数 = query.参数名;\n      this.classIN = classIN;\n      this.queryInfo.classId = this.classIN.classId;\n      // console.log(this.queryInfo)\n      this.Stuitem.classId = this.classIN.classId;\n      this.queryfindStudent.classId = this.classIN.classId;\n    }\n    this.getStudentList();\n    this.getfindStudent();\n  },\n  methods: {\n    //打开添加学生框\n    addDialogStudent() {\n      this.addDialogVisible = true;\n      this.getfindStudent();\n    },\n    //查询所有可加入班级的学生\n    getfindStudent() {\n      if (this.DXcondition == '') {\n        this.request.get('/service-student/student/page', {\n          params: this.queryfindStudent\n        }).then(res => {\n          if (res.code === '200') {\n            this.tableData = res.data.records;\n            console.log(this.tableData, \"tableData\");\n            this.DXtotal = res.data.total;\n          } else {\n            this.$message.error(\"获取可选学生信息失败！\");\n          }\n        });\n      } else if (this.DXcondition != '') {\n        console.log(this.DXcondition, \"DXcondition\");\n        this.queryfindStudent.stuName = this.DXcondition;\n        this.request.get('/service-student/student/page', {\n          params: this.queryfindStudent\n        }).then(res => {\n          if (res.code === '200') {\n            this.tableData = res.data.records;\n            console.log(this.tableData, \"tableData\");\n            this.DXtotal = res.data.total;\n          } else {\n            this.$message.error(\"获取可选学生信息失败！\");\n          }\n        });\n      }\n    },\n    tonullCondition() {\n      this.queryfindStudent.stuName = '';\n      this.DXcondition = '';\n      this.getfindStudent();\n    },\n    // 添加学生的搜索功能\n    selectStudentClass() {\n      this.getfindStudent();\n    },\n    //查询班级学生列表\n    getStudentList() {\n      this.search = this.condition;\n      if (this.search === '') {\n        this.queryInfo.stuName = '';\n        this.queryInfo.stuId = '';\n        this.request.get('/service-student/student/findStuClass', {\n          params: this.queryInfo\n        }).then(res => {\n          if (res.code === '200') {\n            this.studentlist = res.data.records;\n            // console.log(this.studentlist)\n            this.total = res.data.total;\n          } else {\n            this.$message.error(\"获取\" + this.classIN.className + \"学生列表失败！\");\n          }\n        });\n      } else if (this.search !== '') {\n        this.queryInfo.stuId = this.search;\n        this.queryInfo.pageSize = 6;\n        this.queryInfo.pageNum = 1;\n        // console.log(this.queryInfo)\n        this.request.get('/service-student/student/findStuClass', {\n          params: this.queryInfo\n        }).then(res => {\n          if (res.code === '200') {\n            this.studentlist = res.data.records;\n            // console.log(\"输入的搜索条件是\",this.queryInfo.stuId)\n            if (this.studentlist.length === 0) {\n              this.queryInfo.stuId = '';\n              this.queryInfo.stuName = this.search;\n              this.request.get('/service-student/student/findStuClass', {\n                params: this.queryInfo\n              }).then(res => {\n                if (res.code === '200') {\n                  this.studentlist = res.data.records;\n                  // console.log(\"输入的搜索条件是\",this.queryInfo.stuName)\n                  this.total = res.data.total;\n                  if (this.studentlist.length === 0) {\n                    this.$message.info(\"搜索结果为空！\");\n                  }\n                } else {\n                  this.$message.error(\"获取学生列表失败！\");\n                }\n              });\n            } else {\n              this.total = res.data.total;\n              if (this.studentlist.length === 0) {\n                this.$message.info(\"搜索结果为空！\");\n              }\n            }\n          } else {\n            this.$message.error(\"获取学生数据失败！\");\n          }\n        });\n      }\n    },\n    togetStuList() {\n      this.condition = '';\n      this.getStudentList();\n    },\n    // loadAll() {\n    //     return this.findStudentOb;\n    // },\n    // querySearchAsync(queryString, cb) {\n    //     var restaurants = this.restaurants;\n    //     var results = queryString ? restaurants.filter(this.createStateFilter(queryString)) : restaurants;\n\n    //     clearTimeout(this.timeout);\n    //     this.timeout = setTimeout(() => {\n    //         cb(results);\n    //     }, 3000 * Math.random());\n    // },\n    // createStateFilter(queryString) {\n    //     return (state) => {\n    //         return (state.value.toLowerCase().indexOf(queryString.toLowerCase()) === 0);\n    //     };\n    // },\n    // handleSelect(item) {\n    //     // console.log(item,\"item\")\n    //     this.Stuitem.stuId = item.id + ''\n    // },\n    // 监听添加班级-学生对话框的关闭事件\n    addDialogClosed() {\n      this.$refs.addFormRef.resetFields();\n    },\n    // 点击按钮，添加新班级-学生\n    addStudentClass() {\n      console.log(this.multipleSelection, \"multipleSelection\");\n      for (let i = 0; i < this.multipleSelection.length; i++) {\n        this.multipleSelection[i].classId = this.Stuitem.classId;\n      }\n      console.log(this.multipleSelection, \"multipleSelection\");\n      let total = this.multipleSelection.map(v => ({\n        classId: v.classId,\n        stuId: v.stuId\n      }));\n      console.log(total);\n      this.request.post('/service-student/student/saveBatch', total).then(res => {\n        if (res.code === '200') {\n          this.$message.success(\"添加学生成功！\");\n          this.getfindStudent();\n          this.getStudentList();\n        }\n      });\n    },\n    // 监听pagesize改变的事件\n    handleSizeChange(newSize) {\n      // console.log(newSize)\n      this.queryInfo.pageSize = newSize;\n      this.getStudentList();\n    },\n    // 监听页码值改变的事件\n    handleCurrentChange(newPage) {\n      // console.log(newPage)\n      this.queryInfo.pageNum = newPage;\n      this.getStudentList();\n    },\n    // 监听pagesize改变的事件\n    handleSizeChangeDX(newSize) {\n      // console.log(newSize)\n      this.queryfindStudent.pageSize = newSize;\n      this.getfindStudent();\n    },\n    // 监听页码值改变的事件\n    handleCurrentChangeDX(newPage) {\n      // console.log(newPage)\n      this.queryfindStudent.pageNum = newPage;\n      this.getfindStudent();\n    },\n    // 根据stu_id,class_id删除对应的班级-学生信息\n    async removeStudentById(id) {\n      // console.log(id)\n      const confirmResult = await this.$confirm('此操作将该位学生移出该班级, 是否继续?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).catch(err => err);\n      // 如果用户确认删除，则返回值为字符串:confirm\n      // 如果用户取消了删除，则返回值为字符串:cancel\n      // console.log(confirmResult)\n      if (confirmResult === 'cancel') {\n        return this.$message.info('已取消删除');\n      }\n      if (confirmResult === 'confirm') {\n        this.request.delete('/service-class/class/leave/' + id).then(res => {\n          // console.log(res,\"res\")\n          if (res.code === '200') {\n            this.$message.success(\"删除成功！\");\n            this.getStudentList();\n          } else {\n            this.$message.error(\"删除失败！\");\n          }\n        });\n      }\n    },\n    toggleSelection(rows) {\n      if (rows) {\n        rows.forEach(row => {\n          this.$refs.multipleTable.toggleRowSelection(row);\n        });\n      } else {\n        this.$refs.multipleTable.clearSelection();\n      }\n    },\n    handleSelectionChange(val) {\n      this.multipleSelection = val;\n    },\n    //学习进度按钮\n    study(stuName, stuId) {\n      this.studyDialogVisible = true;\n      this.stuName = stuName;\n      //查找\n      this.request.get('service-progress/progress/findClassProgress', {\n        params: {\n          stuId: stuId,\n          classId: this.queryInfo.classId,\n          pageNum: 1,\n          pageSize: 100\n        }\n      }).then(ress => {\n        this.studyTableData = ress.data.records;\n        for (var i = 0; i < this.studyTableData.length; i++) {\n          this.studyTableData[i].progress = Math.floor(ress.data.records[i].learnedSectionCount / ress.data.records[i].couChaNum * 100).toFixed(1);\n        }\n        console.log(this.studyTableData, '学习记录');\n\n        //查找改班级的所有课程\n        this.request.get('/service-class/class/findClassCourse', {\n          params: {\n            classId: this.queryInfo.classId,\n            pageNum: 1,\n            pageSize: 100\n          }\n        }).then(res => {\n          this.allCourse = res.data.records;\n\n          // for(let i=0;i<ress.data.total;i++){\n          //   let course = {\n          //     couName: '',\n          //     progress: ''\n          //   }\n          //   course.couName = ress.data.records[i].couName\n          //   console.log(ress.data.records[i].learnedSectionCount,\"WWWWWWWWWWWWWWWWWWW\")\n          //   course.progress =  Math.floor((ress.data.records[i].learnedSectionCount / ress.data.records[i].couChaNum)*100).toFixed(1)\n          //  console.log(course.progress,\"QQQQQQQQQQQQQQQQ\")\n          //\n          //   this.studyTableData.push(course)\n          //\n          // }\n\n          // for(let i=0;i< this.allCourse.length;i++){\n          //\n          //   if(this.allCourse[i].couName != this.studyTableData[i].couName){\n          //       let course = {\n          //         couName: '',\n          //         progress: ''\n          //       }\n          //       course.couName = this.allCourse[i].couName\n          //       course.progress = 0\n          //       this.studyTableData.push(course)\n          //   }\n          // }\n          // console.log(this.studyTableData,'===================list')\n        });\n\n        //this.studyTableData = res.data.records\n      });\n    },\n\n    handleClose(done) {\n      done();\n      this.studyTableData = [];\n      this.allCourseLength = 0;\n    }\n  },\n  mounted() {\n    this.restaurants = this.loadAll();\n  }\n};","map":{"version":3,"mappings":"AA0FA;EACAA;IACA;MACA;MACAC;QACAC;QACA;QACAC;QACA;QACAC;QACAC;QACAC;MACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACA;MACAC;MACA;MACAC;MACAR;MACAS;MACA;MACAC;QACAV;MACA;MACA;MACAW;QACAX,UACA;UAAAY;UAAAC;UAAAC;QAAA;MAEA;MACAC;MACAC;MACAC;QACArB;QACAsB;MACA;MACAC;QACAnB;QACAJ;QACAE;QACAD;MACA;MACAuB;MACAC;MACAC;QACA1B;QACA;MACA;;MACA2B;MACAC;MACAC;MACAC;MACAC;IACA;EAEA;EACAC;IACA;IACA;IACA;MACA;MACA;MACA;MACA;MACA;MACA;IACA;IACA;IACA;EACA;EACAC;IACA;IACAC;MACA;MACA;IACA;IACA;IACAC;MACA;QACA;UACAC;QACA;UACA;YACA;YACAC;YACA;UACA;YACA;UACA;QACA;MACA;QACAA;QACA;QACA;UACAD;QACA;UACA;YACA;YACAC;YACA;UACA;YACA;UACA;QACA;MACA;IACA;IACAC;MACA;MACA;MACA;IACA;IACA;IACAC;MACA;IACA;IACA;IACAC;MACA;MACA;QACA;QACA;QACA;UACAJ;QACA;UACA;YACA;YACA;YACA;UACA;YACA;UACA;QACA;MACA;QACA;QACA;QACA;QACA;QACA;UACAA;QACA;UACA;YACA;YACA;YACA;cACA;cACA;cACA;gBACAA;cACA;gBACA;kBACA;kBACA;kBACA;kBACA;oBACA;kBACA;gBACA;kBACA;gBACA;cACA;YACA;cACA;cACA;gBACA;cACA;YACA;UACA;YACA;UACA;QACA;MACA;IACA;IACAK;MACA;MACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;;IAEA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACAC;MACA;IACA;IACA;IACAC;MACAN;MACA;QACA;MACA;MACAA;MACA;QAAArC;QAAAG;MAAA;MACAkC;MACA;QACA;UACA;UACA;UACA;QAEA;MACA;IACA;IACA;IACAO;MACA;MACA;MACA;IACA;IACA;IACAC;MACA;MACA;MACA;IACA;IACA;IACAC;MACA;MACA;MACA;IACA;IACA;IACAC;MACA;MACA;MACA;IACA;IACA;IACA;MACA;MACA;QACAC;QACAC;QACAC;MACA;MACA;MACA;MACA;MACA;QACA;MACA;MACA;QACA;UACA;UACA;YACA;YACA;UACA;YACA;UACA;QACA;MACA;IACA;IACAC;MACA;QACAC;UACA;QACA;MACA;QACA;MACA;IACA;IACAC;MACA;IACA;IACA;IACAC;MACA;MACA;MACA;MACA;QACAlB;UACAjC;UACAH;UACAC;UACAC;QACA;MACA;QACA;QACA;UACA;QAGA;QACAmC;;QAEA;QACA;UACAD;YACApC;YACAC;YACAC;UACA;QACA;UACA;;UAMA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;QACA;;QAIA;MAEA;IACA;;IACAqD;MACAC;MACA;MACA;IACA;EACA;EACAC;IACA;EACA;AACA","names":["data","queryInfo","classId","pageNum","pageSize","stuId","stuName","condition","DXcondition","search","studentlist","total","DXtotal","addDialogVisible","studyDialogVisible","studyTableData","addForm","addFormRules","required","message","trigger","restaurants","timeout","classIN","className","queryfindStudent","findStudent","findStudentOb","Stuitem","tableData","multipleSelection","allCourseLength","allCourse","progress","created","methods","addDialogStudent","getfindStudent","params","console","tonullCondition","selectStudentClass","getStudentList","togetStuList","addDialogClosed","addStudentClass","handleSizeChange","handleCurrentChange","handleSizeChangeDX","handleCurrentChangeDX","confirmButtonText","cancelButtonText","type","toggleSelection","rows","handleSelectionChange","study","handleClose","done","mounted"],"sourceRoot":"src/views/class","sources":["studentG.vue"],"sourcesContent":["<template>\r\n    <div>\r\n\r\n        <div class=\"studentG-top\">\r\n            <!-- 跳转到班级管理 -->\r\n            <el-page-header @back=\"$router.push('/classes')\" :content=\"this.classIN.className\"></el-page-header>\r\n            <!-- 搜索与添加区域 -->\r\n            <el-row :gutter=\"30\">\r\n                <el-col :span=\"5\">\r\n                    <el-input placeholder=\"请输入内容\" v-model=\"condition\" clearable @clear=\"togetStuList\">\r\n                        <el-button slot=\"append\" icon=\"el-icon-search\" @click=\"getStudentList\"></el-button>\r\n                    </el-input>\r\n                </el-col>\r\n                <el-col :span=\"4\">\r\n                    <el-button type=\"primary\" @click=\"addDialogStudent\">添加学生</el-button>\r\n                </el-col>\r\n            </el-row>\r\n        </div>\r\n\r\n        <!-- 班级列表区域 -->\r\n        <el-table :header-cell-style=\"{ backgroundColor: 'rgb(244, 244, 245)' }\" :data=\"studentlist\" border stripe>\r\n            <!-- <el-table-column prop=\"query.class_name\" label=\"学生班级\"></el-table-column> -->\r\n            <el-table-column prop=\"stuId\" label=\"学生id\"></el-table-column>\r\n            <el-table-column prop=\"stuName\" label=\"学生姓名\"></el-table-column>\r\n            <el-table-column prop=\"joinDate\" label=\"加入时间\"></el-table-column>\r\n            <el-table-column prop=\"stuStudyTime\" label=\"学生学习时长\"></el-table-column>\r\n            <el-table-column prop=\"stuScore\" label=\"积分\"></el-table-column>\r\n            <el-table-column prop=\"operation\" label=\"操作\">\r\n                <template slot-scope=\"scope\">\r\n                    <!-- 删除按钮 -->\r\n                    <el-button type=\"danger\" icon=\"el-icon-delete\" @click=\"removeStudentById(scope.row.id)\">\r\n                    </el-button>\r\n                    <!-- 学习进度 -->\r\n                    <el-button type=\"success\" @click=\"study(scope.row.stuName,scope.row.stuId)\" >学习进度</el-button>\r\n                </template>\r\n            </el-table-column>\r\n        </el-table>\r\n        <!-- 分页区域 -->\r\n        <el-pagination @size-change=\"handleSizeChange\" @current-change=\"handleCurrentChange\"\r\n            :current-page=\"queryInfo.pageNum\" :page-sizes=\"[2, 4, 6]\" :page-size=\"queryInfo.pageSize\"\r\n            layout=\"total, sizes, prev, pager, next, jumper\" :total=\"total\">\r\n        </el-pagination>\r\n\r\n        <!-- 添加班级-学生的对话框 -->\r\n        <el-dialog title=\"添加学生\" :visible.sync=\"addDialogVisible\" width=\"40%\" @close=\"addDialogClosed\">\r\n            <!-- 搜索框 -->\r\n            <el-input placeholder=\"请输入想要搜索学生的姓名\" v-model=\"DXcondition\" clearable @clear=\"tonullCondition\">\r\n                <el-button slot=\"append\" icon=\"el-icon-search\" @click=\"selectStudentClass\"></el-button>\r\n            </el-input>\r\n            <!-- 多选表格 -->\r\n            <el-table ref=\"multipleTable\" :data=\"tableData\" tooltip-effect=\"dark\" style=\"width: 100%\"\r\n                @selection-change=\"handleSelectionChange\">\r\n                <el-table-column type=\"selection\" width=\"55\">\r\n                </el-table-column>\r\n                <el-table-column label=\"用户Id\" width=\"150\">\r\n                    <template slot-scope=\"scope\">{{ scope.row.stuId }}</template>\r\n                </el-table-column>\r\n                <el-table-column prop=\"stuName\" label=\"学生姓名\" width=\"120\">\r\n                </el-table-column>\r\n            </el-table>\r\n            <!-- 分页区域 -->\r\n            <el-pagination @size-change=\"handleSizeChangeDX\" @current-change=\"handleCurrentChangeDX\"\r\n                :current-page=\"queryfindStudent.pageNum\" :page-size=\"queryfindStudent.pageSize\"\r\n                layout=\"total, prev, pager, next\" :total=\"DXtotal\">\r\n            </el-pagination>\r\n            <div style=\"margin-top: 20px\">\r\n                <el-button @click=\"toggleSelection()\">取消选择</el-button>\r\n                <el-button @click=\"addStudentClass()\">确定添加</el-button>\r\n            </div>\r\n        </el-dialog>\r\n\r\n        <!-- 学习进度弹窗 -->\r\n        <el-dialog\r\n            :title=\"stuName\"\r\n            :visible.sync=\"studyDialogVisible\"\r\n            width=\"34%\"\r\n            :before-close=\"handleClose\">\r\n          <el-table class=\"study-table\"  :header-cell-style=\"{ backgroundColor: 'rgb(244, 244, 245)' }\" :data=\"studyTableData\" >\r\n            <el-table-column prop=\"couName\" label=\"课程名称\" ></el-table-column>\r\n            <el-table-column prop=\"progress\" label=\"学习进度\" width=\"220\">\r\n              <template slot-scope=\"scope\">\r\n                <el-progress :percentage=\"scope.row.progress\" color=\"#67C23A\"></el-progress>\r\n              </template>\r\n            </el-table-column>\r\n          </el-table>\r\n        </el-dialog>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n    data() {\r\n        return {\r\n            //获取班级-学生列表的参数对象\r\n            queryInfo: {\r\n                classId: '',\r\n                // 当前的页数\r\n                pageNum: 1,\r\n                // 当当前每页显示多少条数据\r\n                pageSize: 6,\r\n                stuId: '',\r\n                stuName: ''\r\n            },\r\n            condition: '',\r\n            DXcondition: '',\r\n            search: '',\r\n            studentlist: [],\r\n            total: 0,\r\n            DXtotal: 0,\r\n            // 控制添加班级-学生对话框的显示与隐藏\r\n            addDialogVisible: false,\r\n            //学习进度弹框\r\n            studyDialogVisible: false,\r\n            stuName: '',\r\n            studyTableData: [],\r\n            // 添加班级-学生的表单数据\r\n            addForm: {\r\n                stuName: ''\r\n            },\r\n            // 添加表单的验证规则对象\r\n            addFormRules: {\r\n                stuName: [\r\n                    { required: true, message: '请输入学生姓名', trigger: 'blur' }\r\n                ]\r\n            },\r\n            restaurants: [],\r\n            timeout: null,\r\n            classIN: {\r\n                classId: '',\r\n                className: ''\r\n            },\r\n            queryfindStudent: {\r\n                stuName: '',\r\n                classId: '',\r\n                pageSize: 3,\r\n                pageNum: 1\r\n            },\r\n            findStudent: [],\r\n            findStudentOb: [],\r\n            Stuitem: {\r\n                classId: ''\r\n                // stuId: ''\r\n            },\r\n            tableData: [],\r\n            multipleSelection: [],\r\n            allCourseLength: 0,\r\n            allCourse:[],\r\n            progress:''\r\n        }\r\n\r\n    },\r\n    created() {\r\n        const classIN = this.$route.query;\r\n        // console.log(classIN);\r\n        if (classIN) {\r\n            // var 参数 = query.参数名;\r\n            this.classIN = classIN\r\n            this.queryInfo.classId = this.classIN.classId\r\n            // console.log(this.queryInfo)\r\n            this.Stuitem.classId = this.classIN.classId\r\n            this.queryfindStudent.classId = this.classIN.classId\r\n        }\r\n        this.getStudentList()\r\n        this.getfindStudent()\r\n    },\r\n    methods: {\r\n        //打开添加学生框\r\n        addDialogStudent(){\r\n            this.addDialogVisible = true\r\n            this.getfindStudent()\r\n        },\r\n        //查询所有可加入班级的学生\r\n        getfindStudent() {\r\n            if (this.DXcondition == '') {\r\n                this.request.get('/service-student/student/page', {\r\n                    params: this.queryfindStudent\r\n                }).then(res => {\r\n                    if (res.code === '200') {\r\n                        this.tableData = res.data.records\r\n                        console.log(this.tableData, \"tableData\")\r\n                        this.DXtotal = res.data.total\r\n                    } else {\r\n                        this.$message.error(\"获取可选学生信息失败！\")\r\n                    }\r\n                })\r\n            } else if (this.DXcondition != '') {\r\n                console.log(this.DXcondition, \"DXcondition\")\r\n                this.queryfindStudent.stuName = this.DXcondition\r\n                this.request.get('/service-student/student/page', {\r\n                    params: this.queryfindStudent\r\n                }).then(res => {\r\n                    if (res.code === '200') {\r\n                        this.tableData = res.data.records\r\n                        console.log(this.tableData, \"tableData\")\r\n                        this.DXtotal = res.data.total\r\n                    } else {\r\n                        this.$message.error(\"获取可选学生信息失败！\")\r\n                    }\r\n                })\r\n            }\r\n        },\r\n        tonullCondition() {\r\n            this.queryfindStudent.stuName = ''\r\n            this.DXcondition = ''\r\n            this.getfindStudent()\r\n        },\r\n        // 添加学生的搜索功能\r\n        selectStudentClass() {\r\n            this.getfindStudent()\r\n        },\r\n        //查询班级学生列表\r\n        getStudentList() {\r\n            this.search = this.condition\r\n            if (this.search === '') {\r\n                this.queryInfo.stuName = ''\r\n                this.queryInfo.stuId = ''\r\n                this.request.get('/service-student/student/findStuClass', {\r\n                    params: this.queryInfo\r\n                }).then(res => {\r\n                    if (res.code === '200') {\r\n                        this.studentlist = res.data.records\r\n                        // console.log(this.studentlist)\r\n                        this.total = res.data.total\r\n                    } else {\r\n                        this.$message.error(\"获取\" + this.classIN.className + \"学生列表失败！\")\r\n                    }\r\n                })\r\n            } else if (this.search !== '') {\r\n                this.queryInfo.stuId = this.search\r\n                this.queryInfo.pageSize = 6\r\n                this.queryInfo.pageNum = 1\r\n                // console.log(this.queryInfo)\r\n                this.request.get('/service-student/student/findStuClass', {\r\n                    params: this.queryInfo\r\n                }).then(res => {\r\n                    if (res.code === '200') {\r\n                        this.studentlist = res.data.records\r\n                        // console.log(\"输入的搜索条件是\",this.queryInfo.stuId)\r\n                        if (this.studentlist.length === 0) {\r\n                            this.queryInfo.stuId = ''\r\n                            this.queryInfo.stuName = this.search\r\n                            this.request.get('/service-student/student/findStuClass', {\r\n                                params: this.queryInfo\r\n                            }).then(res => {\r\n                                if (res.code === '200') {\r\n                                    this.studentlist = res.data.records\r\n                                    // console.log(\"输入的搜索条件是\",this.queryInfo.stuName)\r\n                                    this.total = res.data.total\r\n                                    if (this.studentlist.length === 0) {\r\n                                        this.$message.info(\"搜索结果为空！\")\r\n                                    }\r\n                                } else {\r\n                                    this.$message.error(\"获取学生列表失败！\")\r\n                                }\r\n                            })\r\n                        } else {\r\n                            this.total = res.data.total\r\n                            if (this.studentlist.length === 0) {\r\n                                this.$message.info(\"搜索结果为空！\")\r\n                            }\r\n                        }\r\n                    } else {\r\n                        this.$message.error(\"获取学生数据失败！\")\r\n                    }\r\n                })\r\n            }\r\n        },\r\n        togetStuList() {\r\n            this.condition = ''\r\n            this.getStudentList()\r\n        },\r\n        // loadAll() {\r\n        //     return this.findStudentOb;\r\n        // },\r\n        // querySearchAsync(queryString, cb) {\r\n        //     var restaurants = this.restaurants;\r\n        //     var results = queryString ? restaurants.filter(this.createStateFilter(queryString)) : restaurants;\r\n\r\n        //     clearTimeout(this.timeout);\r\n        //     this.timeout = setTimeout(() => {\r\n        //         cb(results);\r\n        //     }, 3000 * Math.random());\r\n        // },\r\n        // createStateFilter(queryString) {\r\n        //     return (state) => {\r\n        //         return (state.value.toLowerCase().indexOf(queryString.toLowerCase()) === 0);\r\n        //     };\r\n        // },\r\n        // handleSelect(item) {\r\n        //     // console.log(item,\"item\")\r\n        //     this.Stuitem.stuId = item.id + ''\r\n        // },\r\n        // 监听添加班级-学生对话框的关闭事件\r\n        addDialogClosed() {\r\n            this.$refs.addFormRef.resetFields()\r\n        },\r\n        // 点击按钮，添加新班级-学生\r\n        addStudentClass() {\r\n            console.log(this.multipleSelection, \"multipleSelection\")\r\n            for (let i = 0; i < this.multipleSelection.length; i++) {\r\n                this.multipleSelection[i].classId = this.Stuitem.classId\r\n            }\r\n            console.log(this.multipleSelection, \"multipleSelection\")\r\n            let total = this.multipleSelection.map(v => ({ classId: v.classId, stuId: v.stuId }))\r\n            console.log(total)\r\n            this.request.post('/service-student/student/saveBatch', total).then(res => {\r\n                if (res.code === '200') {\r\n                    this.$message.success(\"添加学生成功！\")\r\n                    this.getfindStudent()\r\n                    this.getStudentList()\r\n\r\n                }\r\n            })\r\n        },\r\n        // 监听pagesize改变的事件\r\n        handleSizeChange(newSize) {\r\n            // console.log(newSize)\r\n            this.queryInfo.pageSize = newSize\r\n            this.getStudentList()\r\n        },\r\n        // 监听页码值改变的事件\r\n        handleCurrentChange(newPage) {\r\n            // console.log(newPage)\r\n            this.queryInfo.pageNum = newPage\r\n            this.getStudentList()\r\n        },\r\n        // 监听pagesize改变的事件\r\n        handleSizeChangeDX(newSize) {\r\n            // console.log(newSize)\r\n            this.queryfindStudent.pageSize = newSize\r\n            this.getfindStudent()\r\n        },\r\n        // 监听页码值改变的事件\r\n        handleCurrentChangeDX(newPage) {\r\n            // console.log(newPage)\r\n            this.queryfindStudent.pageNum = newPage\r\n            this.getfindStudent()\r\n        },\r\n        // 根据stu_id,class_id删除对应的班级-学生信息\r\n        async removeStudentById(id) {\r\n            // console.log(id)\r\n            const confirmResult = await this.$confirm('此操作将该位学生移出该班级, 是否继续?', '提示', {\r\n                confirmButtonText: '确定',\r\n                cancelButtonText: '取消',\r\n                type: 'warning'\r\n            }).catch(err => err)\r\n            // 如果用户确认删除，则返回值为字符串:confirm\r\n            // 如果用户取消了删除，则返回值为字符串:cancel\r\n            // console.log(confirmResult)\r\n            if (confirmResult === 'cancel') {\r\n                return this.$message.info('已取消删除')\r\n            }\r\n            if (confirmResult === 'confirm') {\r\n                this.request.delete('/service-class/class/leave/' + id).then(res => {\r\n                    // console.log(res,\"res\")\r\n                    if (res.code === '200') {\r\n                        this.$message.success(\"删除成功！\")\r\n                        this.getStudentList()\r\n                    } else {\r\n                        this.$message.error(\"删除失败！\")\r\n                    }\r\n                })\r\n            }\r\n        },\r\n        toggleSelection(rows) {\r\n            if (rows) {\r\n                rows.forEach(row => {\r\n                    this.$refs.multipleTable.toggleRowSelection(row);\r\n                });\r\n            } else {\r\n                this.$refs.multipleTable.clearSelection();\r\n            }\r\n        },\r\n        handleSelectionChange(val) {\r\n            this.multipleSelection = val;\r\n        },\r\n        //学习进度按钮\r\n        study(stuName,stuId){\r\n          this.studyDialogVisible = true;\r\n          this.stuName = stuName\r\n          //查找\r\n          this.request.get('service-progress/progress/findClassProgress',{\r\n            params:{\r\n              stuId: stuId,\r\n              classId: this.queryInfo.classId,\r\n              pageNum: 1,\r\n              pageSize: 100\r\n            }\r\n          }).then(ress => {\r\n            this.studyTableData=ress.data.records\r\n           for (var i=0;i<this.studyTableData.length;i++){\r\n             this.studyTableData[i].progress =  Math.floor((ress.data.records[i].learnedSectionCount / ress.data.records[i].couChaNum)*100).toFixed(1)\r\n\r\n\r\n           }\r\n              console.log( this.studyTableData,'学习记录')\r\n\r\n              //查找改班级的所有课程\r\n              this.request.get('/service-class/class/findClassCourse',{\r\n                params:{\r\n                  classId:  this.queryInfo.classId,\r\n                  pageNum: 1,\r\n                  pageSize: 100\r\n                }\r\n              }).then(res => {\r\n                this.allCourse = res.data.records\r\n\r\n\r\n\r\n\r\n\r\n                // for(let i=0;i<ress.data.total;i++){\r\n                //   let course = {\r\n                //     couName: '',\r\n                //     progress: ''\r\n                //   }\r\n                //   course.couName = ress.data.records[i].couName\r\n                //   console.log(ress.data.records[i].learnedSectionCount,\"WWWWWWWWWWWWWWWWWWW\")\r\n                //   course.progress =  Math.floor((ress.data.records[i].learnedSectionCount / ress.data.records[i].couChaNum)*100).toFixed(1)\r\n                //  console.log(course.progress,\"QQQQQQQQQQQQQQQQ\")\r\n                //\r\n                //   this.studyTableData.push(course)\r\n                //\r\n                // }\r\n\r\n                // for(let i=0;i< this.allCourse.length;i++){\r\n                //\r\n                //   if(this.allCourse[i].couName != this.studyTableData[i].couName){\r\n                //       let course = {\r\n                //         couName: '',\r\n                //         progress: ''\r\n                //       }\r\n                //       course.couName = this.allCourse[i].couName\r\n                //       course.progress = 0\r\n                //       this.studyTableData.push(course)\r\n                //   }\r\n                // }\r\n                // console.log(this.studyTableData,'===================list')\r\n              })\r\n\r\n\r\n\r\n              //this.studyTableData = res.data.records\r\n\r\n          })\r\n        },\r\n        handleClose(done) {\r\n          done();\r\n          this.studyTableData = []\r\n          this.allCourseLength = 0\r\n        }\r\n    },\r\n    mounted() {\r\n        this.restaurants = this.loadAll();\r\n    }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.studentG-top {\r\n    margin-top: -10px;\r\n\r\n    .el-page-header {\r\n        margin-bottom: 20px;\r\n    }\r\n}\r\n\r\n.el-table {\r\n    margin-top: 20px;\r\n}\r\n\r\n.el-pagination {\r\n    margin-top: 20px;\r\n}\r\n\r\nh3 {\r\n    text-align: center;\r\n}\r\n\r\n.study-table{\r\n  margin-top: -20px;\r\n  margin-bottom: 10px;\r\n  width: 100%;\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}